{% extends "base.html" %}
{% load i18n %}
{% block content %}
<div class="container py-5" style="max-width:520px">
  <div class="text-center mb-4">
    <h2 class="fw-bold mb-2">{% trans "Set new password" %}</h2>
    <p class="text-muted">{% trans "Please enter your new password twice" %}</p>
  </div>
  
  {% if token_fail %}
    <div class="alert alert-danger">
      {% url 'account_reset_password' as passwd_reset_url %}
      {% blocktrans %}
      The password reset link was invalid, possibly because it has already been used. Please request a <a href="{{ passwd_reset_url }}">new password reset</a>.
      {% endblocktrans %}
    </div>
  {% else %}
    <form method="post" action="" class="ep-card p-4">
      {% csrf_token %}
      
      {% for field in form %}
        <div class="mb-3">
          <label class="form-label small fw-medium" for="{{ field.id_for_label }}">{{ field.label }}</label>
          {{ field }}
          {% if field.help_text %}
            <div class="form-text text-muted small">{{ field.help_text|safe }}</div>
          {% endif %}
          {% for err in field.errors %}
            <div class="form-text text-danger small">{{ err }}</div>
          {% endfor %}
          
          {% if field.name == 'password1' %}
            <ul class="list-unstyled mt-2 mb-0">
              <li class="small text-muted">At least 8 characters</li>
              <li class="small text-muted">Not entirely numeric</li>
              <li class="small text-muted">Not a common password</li>
            </ul>
          {% endif %}
        </div>
      {% endfor %}
      
      <button class="btn btn-primary w-100 mb-3" type="submit">{% trans "Change Password" %}</button>
      <div class="text-center">
        <a href="{% url 'account_login' %}" class="text-muted small">{% trans "Back to login" %}</a>
      </div>
    </form>
  {% endif %}
</div>
{% endblock %}
